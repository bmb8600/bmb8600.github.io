<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Self-Assessment Quiz</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <h1>Self-Assessment Quiz</h1>
    <hr>

    <nav>
        <a href="index.html">Home</a> |
        <a href="Key Concepts.html">Key Concepts</a> |
        <a href="How PWAs Work.html">How PWAs Work</a> |
        <a href="PWAs vs Others.html">PWAs vs. Apps and Sites</a> |
        <a href="References.html">References</a> |
        <a href="About.html">About</a> |
        <a href="Quiz.html">Self-Assessment Quiz</a>
    </nav>

    <hr>
<!-- Using an ID for styling and practicality-->
    <form id="quizForm">

<!--Using labels for questions-->
        <h3>1. Fill in the blank</h3>
        <label>The P in PWA stands for ____________.</label>
        <input type="text" id="q1">

<!--Setting the input type to radio for MCQs-->
<!--Giving inputs names and values as well-->
        <h3>2. Which technology are Service Workers served over?</h3>
        <label><input type="radio" name="q2" value="DNS"> DNS</label>
        <label><input type="radio" name="q2" value="HTTPS"> HTTPS</label>
        <label><input type="radio" name="q2" value="HTTP"> HTTP</label>

        <h3>3. What file is essential for enabling the "add to home screen" feature?</h3>
        <label><input type="radio" name="q3" value="Web App Manifest"> Web App Manifest</label>
        <label><input type="radio" name="q3" value="Image File"> Image File</label>
        <label><input type="radio" name="q3" value="CSS Stylesheet"> CSS Stylesheet</label>

        <h3>4. Which platform can PWAs run on?</h3>
        <label><input type="radio" name="q4" value="Any device with a modern browser"> Any device with a modern browser</label>
        <label><input type="radio" name="q4" value="Only Android phones"> Only Android phones</label>
        <label><input type="radio" name="q4" value="Only desktop computers"> Only desktop computers</label>

<!--Setting the input type to checkbox for multi-select questions-->
        <h3>5. Select all benefits of PWAs:</h3>
        <label><input type="checkbox" name="q5" value="Installable"> Installable</label>
        <label><input type="checkbox" name="q5" value="Works offline"> Works offline</label>
        <label><input type="checkbox" name="q5" value="Easily shareable via URL"> Easily shareable via URL</label>
        <label><input type="checkbox" name="q5" value="Always expensive to build"> Always expensive to build</label>

        <h3>6. Which are features of a Service Worker?</h3>
        <label><input type="checkbox" name="q6" value="Caches important files"> Caches important files</label>
        <label><input type="checkbox" name="q6" value="Enables push notifications"> Enables push notifications</label>
        <label><input type="checkbox" name="q6" value="Edits your HTML automatically"> Edits your HTML automatically</label>

        <h3>7. Traditional websites usually:</h3>
        <label><input type="radio" name="q7" value="Do not work offline"> Do not work offline</label>
        <label><input type="radio" name="q7" value="Work offline by default"> Work offline by default</label>
        <label><input type="radio" name="q7" value="Must be installed from an app store"> Must be installed from an app store</label>

        <h3>8. Which features are part of the Web App Manifest?</h3>
        <label><input type="checkbox" name="q8" value="App name"> App name</label>
        <label><input type="checkbox" name="q8" value="Icons"> Icons</label>
        <label><input type="checkbox" name="q8" value="Theme color"> Theme color</label>
        <label><input type="checkbox" name="q8" value="Debugging Tools"> Debugging Tools</label>

        <br><br>

<!--Creating buttons for submitting and resetting and making them run a later function when clicked-->
        <button type="button" onclick="gradeQuiz()">Submit Quiz</button>
        <button type="button" onclick="resetQuiz()">Reset</button>
    </form>
<!--Creating a div element to house the results-->
    <div id="results"></div>

<script>

function gradeQuiz() {

/*Initializing a score variable and result array to keep track of correct answers*/
    let score = 0;
    let resultArray = [];

/*Storing correct answers for each question in a constant object */
    const answers = {
        q1: "progressive",
        q2: "HTTPS",
        q3: "Web App Manifest",
        q4: "Any device with a modern browser",
        q5: ["Installable", "Works offline", "Easily shareable via URL"],
        q6: ["Caches important files", "Enables push notifications"],
        q7: "Do not work offline",
        q8: ["App name", "Icons", "Theme color"]
    };

/* Getting the user's answers by the id set above*/
    let q1Answer = document.getElementById("q1").value;

/*Trimming whitespace and converting to lowercase to compare accurately*/
    q1Answer = q1Answer.trim().toLowerCase();

/*Comparing the input to the exact answer stored in the answers object*/
    if (q1Answer === answers.q1) {

/*Adding 1 to the score for a correct answer*/
        score = score + 1;

/*Storing the correct message for the answer in the result array for when results are displayed
Also using HTML span elements with classes for CSS styling the correct text*/
        resultArray[0] = "<p><strong>Q1:</strong> <span class='correct'>Correct</span></p>";

    } else {
/*Store the incorrect message and show correct answer
Also using HTML span elements with classes for CSS styling the incorrect text*/
        resultArray[0] = "<p><strong>Q1:</strong> <span class='incorrect'>Incorrect</span> — Correct answer: Progressive</p>";
    }

/*Creating an array of the multiple choice questions*/
    let mcQuestions = [2, 3, 4, 7];

/*Loop through each question number in the array using forEach method*/
    mcQuestions.forEach(function(questionNumber) {

        let questionName = "q" + questionNumber;

/* Find the selected radio button using querySelector, name values, and checked pseudo-class */
        let userChoice = document.querySelector("input[name='" + questionName + "']:checked");

/*Creating a variable to hold the correct answer from the answers object*/
        let correctAnswer = answers[questionName];

/*Check if user made a selection then execute the following*/
        if (userChoice !== null) {

            if (userChoice.value === correctAnswer) {
                score = score + 1;

/* Store the correct message for this question, subtracting 1 to match array index*/
                resultArray[questionNumber - 1] =
                    "<p><strong>Q" + questionNumber + ":</strong> <span class='correct'>Correct</span></p>";
            } else {

/* If the user's choice doesn't match the correct answer, store the incorrect message along with the correct answer*/
                resultArray[questionNumber - 1] =
                    "<p><strong>Q" + questionNumber + ":</strong> <span class='incorrect'>Incorrect</span> — Correct answer: "
                    + correctAnswer + "</p>";
            }   

        } else {
/* If no answer was selected, store that info along with the correct answer*/
            resultArray[questionNumber - 1] =
                "<p><strong>Q" + questionNumber + ":</strong> <span class='incorrect'>No answer selected</span> — Correct answer: "
                + correctAnswer + "</p>";
        }

    });

/*Creating a function to handle multi-select checkbox questions*/
function checkMultiSelect(questionNumber) {

    let questionName = "q" + questionNumber;

/*Creating a Nodelist to hold all selected checkboxes for this question */
    let selectedBoxes = document.querySelectorAll("input[name='" + questionName + "']:checked");

/*Putting user-selected answers into an array */
    let userAnswers = [];
/*Loop through each selected checkbox and add its value to the userAnswers array using push method*/
    selectedBoxes.forEach(function(box) {
        userAnswers.push(box.value);
    });

/*Getting the correct answers for this question from the answers object*/
    let correctAnswers = answers[questionName];

 /*First check if the number of user-selected answers matches the number of correct answers*/
    let sameAmount = (userAnswers.length === correctAnswers.length);

/*Then check if each user-selected answer is in the correct answers array using a for loop*/
    let allMatch = true;
    for (let i = 0; i < userAnswers.length; i++) {
        if (!correctAnswers.includes(userAnswers[i])) {
            allMatch = false;
        }
    }
/*Determine if the overall answer is correct based on both checks*/
    let isCorrect = sameAmount && allMatch;

/*If correct, add 1 to the score*/
    if (isCorrect) {
        score = score + 1;
    }

/*Store the result correct result message*/
    if (isCorrect) {
        resultArray[questionNumber - 1] =
            "<p><strong>Q" + questionNumber +
            ":</strong> <span class='correct'>Correct</span></p>";
    } else {
/*Store the result incorrect result message*/
        resultArray[questionNumber - 1] =
            "<p><strong>Q" + questionNumber +
            ":</strong> <span class='incorrect'>Incorrect</span> — Correct answers: "
/* Using .join to turn the array into a comma-separated string*/
            + correctAnswers.join(", ") + "</p>";
    }
}

/*Calling the checkMultiSelect function for questions 5, 6, and 8*/
checkMultiSelect(5);
checkMultiSelect(6);
checkMultiSelect(8);

/* Declaring a variable for total number of questions */
let totalQuestions = 8;

/*Calculating the percentage score to include in the final results
And using math.round to round to the nearest whole number*/
let percentage = Math.round((score / totalQuestions) * 100);

/*Determining if the user passed or failed based on a 70% passing score*/
let passFail;
if (percentage >= 70) {
    passFail = "<span class='correct'>PASS</span>";
} else {
    passFail = "<span class='incorrect'>FAIL</span>";
}

/*Building the final results message using concatenation and HTML formatting*/
let finalMessage = "";
finalMessage += "<h3>Your Score: " + score + "/" + totalQuestions;
finalMessage += " (" + percentage + "%) — " + passFail + "</h3>";
/*Using join method to combine all result messages into a single string*/
finalMessage += resultArray.join("");

/*Placing the final message into the results div*/
document.getElementById("results").innerHTML = finalMessage;

}

/*Creating a function to clear the form and results*/
function resetQuiz() {

/*Using the quiz id and form reset method to clear all inputs*/
    document.getElementById("quizForm").reset();

/*Clearing the results div by setting it to an empty string*/
    document.getElementById("results").innerHTML = "";
}

</script>
</body>
</html>